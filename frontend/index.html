<!DOCTYPE html>
<html>
<head>
  <title>Student CRUD</title>
  <style>
    body { font-family: Arial; margin: 40px; }
    input, button { margin: 5px; padding: 5px; }
    table { border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid black; padding: 8px; }
  </style>
</head>
<body>

<h2>Student CRUD Application</h2>

<!-- CREATE / UPDATE -->
<h3>Add / Update Student</h3>
<input type="hidden" id="id">
<input type="text" id="name" placeholder="Name">
<input type="text" id="roll" placeholder="Roll Number">
<button onclick="save()">Save</button>

<!-- READ -->
<h3>Student List</h3>
<button onclick="load()">Load Students</button>

<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Name</th>
      <th>Roll</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody id="table"></tbody>
</table>

<script>
const API = "http://localhost:3000/students";

// LOAD (READ)
function load() {
  fetch(API)
    .then(res => res.json())
    .then(data => {
      const table = document.getElementById("table");
      table.innerHTML = "";
      data.forEach(s => {
        table.innerHTML += `
          <tr>
            <td>${s.id}</td>
            <td>${s.name}</td>
            <td>${s.roll}</td>
            <td>
              <button onclick="edit(${s.id}, '${s.name}', '${s.roll}')">Edit</button>
              <button onclick="remove(${s.id})">Delete</button>
            </td>
          </tr>`;
      });
    });
}

// CREATE / UPDATE
function save() {
  const id = document.getElementById("id").value;
  const name = document.getElementById("name").value;
  const roll = document.getElementById("roll").value;

  const method = id ? "PUT" : "POST";
  const url = id ? `${API}/${id}` : API;

  fetch(url, {
    method,
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ name, roll })
  }).then(() => {
    clear();
    load();
  });
}

// EDIT
function edit(id, name, roll) {
  document.getElementById("id").value = id;
  document.getElementById("name").value = name;
  document.getElementById("roll").value = roll;
}

// DELETE
function remove(id) {
  fetch(`${API}/${id}`, { method: "DELETE" })
    .then(() => load());
}

function clear() {
  document.getElementById("id").value = "";
  document.getElementById("name").value = "";
  document.getElementById("roll").value = "";
}
</script>

</body>
</html>
